# 15-Blocksworld with Bayesian Heuristic Learning

## Overview

This project attempts to implements a solution to the 15-Blocksworld problem, a classic planning domain where the goal is to stack 15 blocks in a specific order (block 1 on the table, block 2 on block 1, etc.). The implementation includes a Bayesian heuristic learning system that combines pattern databases (PDBs) and neural networks to guide an IDA* search algorithm. The system learns to estimate the cost-to-goal for states using uncertainty-based task generation, aiming to reproduce results similar to those in the referenced research paper.

## Features

- **BlocksWorld15Domain**: Defines the 15-Blocksworld domain with state representation, operators, and goal checking.
- **PatternDatabase and PDBCollection**: Implements pattern databases for heuristic computation using backward search.
- **NN**: Neural network for predicting heuristic values with aleatoric and epistemic uncertainty.
- **BayesianHeuristic**: Combines PDBs and neural networks for learned heuristics with uncertainty estimation.
- **IDAStar**: IDA* search algorithm for planning with the learned heuristic.
- **Task Generation and Training**: Generates tasks based on epistemic uncertainty and trains the heuristic model iteratively.

## Requirements

To run this project, you need the following dependencies:

- Python 3.8 or higher
- PyTorch (`torch`)
- NumPy (`numpy`)
- SciPy (`scipy`)



## Usage
To run the code type the bash script below

```bash
python main.py
```

The main function will:
- Set random seeds for reproducibility.
- Initialize the 15-Blocksworld domain and heuristic.
- Generate and solve a small number of tasks to demonstrate the system's functionality.
- Print diagnostic information, including feature dimensions, PDB statistics, and sample predictions.


## File Structure

- `main.py`: Main Python script containing all classes and the main execution function.

## Limitations

- The current implementation fails to generate moderately difficult tasks for the neural network. This means it can only solve easier problems. Harder problems generated by the generateTask function either result in a timeout or max-steps reached. 
